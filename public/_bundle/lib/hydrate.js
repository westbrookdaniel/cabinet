function g(r,t){typeof r=="string"?t.string?.(r):Array.isArray(r)?r.flat().forEach((n,e)=>{typeof n=="object"?t.node?.(n,e):t.string?.(n,e)}):t.node?.(r)}function d(r,t){if(typeof t.type=="function")return d(r,t.type(t.attributes));let n=document.createElement(t.type);r?.replaceChildren(n),H(t,n);let e=t.attributes.children,o=[];return e&&g(e,{node:(i,a)=>{o.push(d(r?.children[a??0],i))},string:i=>{o.push(document.createTextNode(i))}}),n.replaceChildren(...o),n}var c=new WeakMap;function H(r,t){c.has(t)&&(c.get(t).forEach(([e,o])=>{t.removeEventListener(e,o)}),c.delete(t)),Object.entries(r.attributes).forEach(([n,e])=>{if(n!=="children"&&e!==void 0){if(n.startsWith("on")&&typeof e=="function"){let o=n.slice(2);t.addEventListener(o,e),c.has(t)?c.get(t).push([o,e]):c.set(t,[[o,e]]);return}t.setAttribute(n,e)}})}var y="popstate",v="beforeunload",L=r=>(r.preventDefault(),r.returnValue=""),m=()=>{removeEventListener(v,L,{capture:!0})};function T(r){let t=r.getLocation(),n=()=>{},e=new Set,o=[],i=[],a=()=>{if(o.length){o[0]?.(a,()=>{o=[],m()});return}for(;i.length;)i.shift()?.();h()},u=s=>{i.push(s),a()},h=()=>{t=r.getLocation(),e.forEach(s=>s())};return{get location(){return t},listen:s=>(e.size===0&&(n=r.listener(h)),e.add(s),()=>{e.delete(s),e.size===0&&n()}),push:(s,f)=>{u(()=>{r.pushState(s,f)})},replace:(s,f)=>{u(()=>{r.replaceState(s,f)})},go:s=>{u(()=>{r.go(s)})},back:()=>{u(()=>{r.back()})},forward:()=>{u(()=>{r.forward()})},createHref:s=>r.createHref(s),block:s=>(o.push(s),o.length===1&&addEventListener(v,L,{capture:!0}),()=>{o=o.filter(f=>f!==s),o.length||m()})}}function E(){let r=()=>`${window.location.pathname}${window.location.hash}${window.location.search}`,t=e=>e;return T({getLocation:()=>k(r(),history.state),listener:e=>(addEventListener(y,e),()=>{removeEventListener(y,e)}),pushState:(e,o)=>{window.history.pushState({...o,key:b()},"",t(e))},replaceState:(e,o)=>{window.history.replaceState({...o,key:b()},"",t(e))},back:()=>window.history.back(),forward:()=>window.history.forward(),go:e=>window.history.go(e),createHref:e=>t(e)})}function k(r,t){let n=r.indexOf("#"),e=r.indexOf("?");return{href:r,pathname:r.substring(0,n>0?e>0?Math.min(n,e):n:e>0?e:r.length),hash:n>-1?r.substring(n,e):"",search:e>-1?r.substring(e):"",state:t}}function b(){return Math.random().toString(36)}function w(r){let t=E();return t.listen(async()=>{let e=t.location.pathname,i=(await import(`/_bundle/pages${e==="/"?"/index":e}.js`)).default;d(r,{type:i,attributes:{}})}),document.querySelectorAll("a").forEach(e=>l(t,e)),new MutationObserver(e=>{e.forEach(o=>{switch(o.type){case"childList":o.addedNodes.forEach(i=>{i instanceof HTMLElement&&(i instanceof HTMLAnchorElement&&l(t,i),i.querySelectorAll("a").forEach(a=>l(t,a)))});break;case"attributes":{let i=o.target;i instanceof HTMLElement&&(i instanceof HTMLAnchorElement&&l(t,i),i.querySelectorAll("a").forEach(a=>l(t,a)))}}})}).observe(document,{childList:!0,subtree:!0,attributes:!0}),t}var p=new WeakMap,l=(r,t)=>{if(p.has(t)){let[n,e]=p.get(t);t.removeEventListener(n,e),p.delete(t)}t.addEventListener("click",n=>{n.preventDefault();let e=t.getAttribute("href");!t.target&&e?.startsWith("/")&&r.push(e)})};function M(r){let t=document.getElementById("_root");if(!t)throw new Error("Root element not found");d(t,{type:r,attributes:{}}),window.router=w(t)}export{M as default};
